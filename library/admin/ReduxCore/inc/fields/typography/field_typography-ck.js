/* global redux_change *//**
 * Typography
 * Dependencies		: google.com, jquery
 * Feature added by : Dovy Paukstys - http://simplerain.com/
 * Date				: 06.14.2013
 */jQuery.noConflict();jQuery(document).ready(function(e){function t(t){var n=jQuery(t).parents(".redux-typography-container:first").attr("id");e(t).hasClass("redux-typography-family");var r=e("#"+n+" select.redux-typography-family").val(),i=e("#"+n+" select.redux-typography-family-backup").val(),s=e("#"+n+" .redux-typography-size").val(),o=e("#"+n+" .redux-typography-height").val(),u=e("#"+n+" .redux-typography-word").val(),a=e("#"+n+" .redux-typography-letter").val(),f=e("#"+n+" select.redux-typography-style").val(),l=e("#"+n+" select.redux-typography-subsets").val(),c=e("#"+n+" .redux-typography-color").val(),h=e("#"+n).data("units"),p=e("#"+n+" .redux-typography-family option:selected"),d=r,v=p.data("google");if(!e("#"+n).hasClass("typography-initialized")){f=e("#"+n+" select.redux-typography-style").data("value");l=e("#"+n+" select.redux-typography-subsets").data("value");f!==""&&(f=String(f));typeof l!==undefined&&(l=String(l));e("#"+n).addClass("typography-initialized")}var m=jQuery.parseJSON(decodeURIComponent(p.data("details")));e("#"+n+" .redux-typography-font-options").val(decodeURIComponent(p.data("details")));if(e(t).hasClass("redux-typography-family")){var g='<option value=""></option>';if(v){var y="";e.each(m.variants,function(e,t){if(t.id===f||Object.size(m.variants)===1){y=' selected="selected"';f=t.id}else y="";g+='<option value="'+t.id+'"'+y+">"+t.name.replace(/\+/g," ")+"</option>"});e("#"+n+" .redux-typography-style").html(g);y="";g='<option value=""></option>';e.each(m.subsets,function(e,t){if(t.id===l||Object.size(m.subsets)===1){y=' selected="selected"';l=t.id}else y="";g+='<option value="'+t.id+'"'+y+">"+t.name.replace(/\+/g," ")+"</option>"});typeof i!="undefined"&&i!==""&&(d+=", "+i);e("#"+n+" .redux-typography-subsets").html(g);e("#"+n+" .redux-typography-subsets").fadeIn("fast");e("#"+n+" .typography-family-backup").fadeIn("fast")}else if(m){e.each(m,function(t,r){if(t===f||t==="normal"){y=' selected="selected"';e("#"+n+" .typography-style .select2-chosen").text(r)}else y="";g+='<option value="'+t+'"'+y+">"+r.replace("+"," ")+"</option>"});e("#"+n+" .redux-typography-style").html(g);e("#"+n+" .redux-typography-subsets").fadeOut("fast");e("#"+n+" .typography-family-backup").fadeOut("fast")}}else e(t).hasClass("redux-typography-family-backup")&&i!==""&&e("#"+n+" .redux-typography-font-family").val(d);if(e("#"+n+" select.redux-typography-style option[value='"+f+"']").length===0){f="";e("#"+n+" select.redux-typography-style").val("")}else f==="400"&&e("#"+n+" select.redux-typography-style").val(f);if(e("#"+n+" select.redux-typography-subsets option[value='"+l+"']").length===0){l="";e("#"+n+" select.redux-typography-subsets").val("")}var b="style_link_"+n;e("."+b).remove();if(r!==null){var w=r.replace(/\s+/g,"+");if(v){var E="http://fonts.googleapis.com/css?family="+w;f&&(E+=":"+f.replace(/\-/g," "));l&&(E+="&subset="+l);e("head").append('<link href="'+E+'" rel="stylesheet" type="text/css" class="'+b+'">');e("#"+n+" .redux-typography-google").val(!0)}else e("#"+n+" .redux-typography-google").val(!1)}e("#"+n+" .typography-preview").css("font-size",s+h);e("#"+n+" .typography-preview").css("font-style","normal");if(f.indexOf("italic")!==-1){e("#"+n+" .typography-preview").css("font-style","italic");e("#"+n+" .typography-font-style").val("italic");f=f.replace("italic","")}else e("#"+n+" .typography-font-style").val("");e("#"+n+" .typography-font-weight").val(f);e("#"+n+" .typography-preview").css("font-weight",f);e("#"+n+" .typography-preview").css("font-family",r+", sans-serif");r==="none"&&r===""&&e("#"+n+" .typography-preview").css("font-family","");o||(o=s);e("#"+n+" .typography-preview").css("line-height",o+h);e("#"+n+" .typography-preview").css("word-spacing",u+h);e("#"+n+" .typography-preview").css("letter-spacing",a+h);s===""?e("#"+n+" .typography-font-size").val(""):e("#"+n+" .typography-font-size").val(s+h);o===""?e("#"+n+" .typography-line-height").val(""):e("#"+n+" .typography-line-height").val(o+h);e("#"+n+" .typography-word-spacing").val(u+h);e("#"+n+" .typography-letter-spacing").val(a+h);if(c){e("#"+n+" .typography-preview").css("color",c);e("#"+n+" .typography-preview").css("background-color",getContrastColour(c))}e("#"+n+" .redux-typography-font-family").val(d);e("#"+n+" .typography-style .select2-chosen").text(e("#"+n+" .redux-typography-style option:selected").text());e("#"+n+" .typography-script .select2-chosen").text(e("#"+n+" .redux-typography-subsets option:selected").text())}Object.size=function(e){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t};jQuery(".redux-typography-container").each(function(){var e=jQuery(this).find(".redux-typography-family");e.data("value")!==""&&jQuery(e).val(e.data("value"));t(e)});jQuery(".redux-typography").on("change",function(){t(this)});jQuery(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){t(this)});e(".redux-typography-color").wpColorPicker({change:function(e,n){redux_change(jQuery(this));jQuery(this).val(n.color.toString());t(jQuery(this))}});jQuery(".redux-typography-size, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!1});jQuery(".redux-typography-height").numeric({allowMinus:!0});jQuery(".redux-typography-family, .redux-typography-family-backup").select2({width:"resolve",triggerChange:!0,allowClear:!0})});